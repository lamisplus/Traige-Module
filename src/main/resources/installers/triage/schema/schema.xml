<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">

    <property name="autoIncrement" value="true"/>

    <changeSet id="20222305-001" author="amos-data-fi">
        <sql>
            CREATE TABLE IF NOT EXISTS triage_vital_sign
            (
                id                 BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                created_date       TIMESTAMP WITHOUT TIME ZONE,
                created_by         VARCHAR(255),
                last_modified_date TIMESTAMP WITHOUT TIME ZONE,
                last_modified_by   VARCHAR(255),
                facility_id        BIGINT,
                body_weight        DOUBLE PRECISION,
                diastolic          DOUBLE PRECISION,
                capture_date       TIMESTAMP WITHOUT TIME ZONE,
                height             DOUBLE PRECISION,
                temperature        DOUBLE PRECISION,
                pulse              DOUBLE PRECISION,
                respiratory_rate   DOUBLE PRECISION,
                person_uuid        VARCHAR(255)                                  NOT NULL,
                visit_id           VARCHAR(255)                                  NOT NULL,
                systolic           DOUBLE PRECISION,
                archived           INTEGER,
                uuid               VARCHAR(255)                            NOT NULL,
                CONSTRAINT pk_triage_vital_sign PRIMARY KEY (id)
                );

            ALTER TABLE triage_vital_sign
                ADD CONSTRAINT uc_triage_vital_sign_uuid UNIQUE (uuid);

            ALTER TABLE triage_vital_sign
                ADD CONSTRAINT FK_TRIAGE_VITAL_SIGN_ON_PERSON_UUID FOREIGN KEY (person_uuid) REFERENCES patient_person (uuid);

            ALTER TABLE triage_vital_sign
                ADD CONSTRAINT FK_TRIAGE_VITAL_SIGN_ON_VISIT FOREIGN KEY (visit_id) REFERENCES patient_visit (uuid);
        </sql>
    </changeSet>

    <changeSet id="2022305-002" author="amos-data-fi">
        <sql>
            CREATE TABLE triage_post_service
            (
                id                  BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                facility_id         BIGINT,
                module_service_code VARCHAR(255),
                module_service_name VARCHAR(255),
                encounter_type      VARCHAR(255),
                CONSTRAINT pk_triage_post_service PRIMARY KEY (id)
            );
        </sql>
    </changeSet>
</databaseChangeLog>
